% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_weights_fw.R
\name{fit_weights_fw}
\alias{fit_weights_fw}
\title{Fit synthetic control weights using Frank–Wolfe on the simplex}
\usage{
fit_weights_fw(
  X,
  y,
  lambda = 0.001,
  max_iter = 2000,
  tol = 1e-06,
  verbose = FALSE
)
}
\arguments{
\item{X}{Numeric matrix of dimension \code{P x Nd}. Pre-treatment donor design.}

\item{y}{Numeric vector of length \code{P}. Pre-treatment treated target.}

\item{lambda}{Nonnegative scalar ridge penalty on weights. Defaults to \code{1e-3}.}

\item{max_iter}{Maximum number of Frank–Wolfe iterations. Defaults to \code{2000}.}

\item{tol}{Convergence tolerance on objective improvement. Defaults to \code{1e-6}.}

\item{verbose}{Logical. If \code{TRUE}, prints occasional progress messages.}
}
\value{
Numeric vector of length \code{Nd} with simplex weights summing to 1.
}
\description{
Solves a simplex-constrained least squares problem
\deqn{\min_{w \in \Delta} \|y - Xw\|^2 + \lambda \|w\|^2}
where \code{w} lies on the probability simplex (\code{w >= 0}, \code{sum(w)=1}).
}
\details{
Designed for large donor sets with warm-start potential and low memory
overhead, particularly when paired with donor screening.

This routine:
\itemize{
\item Initializes weights uniformly on donors
\item Computes quadratic objective and gradient in donor space
\item Uses Frank–Wolfe direction to the best simplex vertex (coordinate descent-like)
\item Performs exact line search for the quadratic objective
}

For best results at scale, screen donors first to a manageable candidate set.
}
\examples{
set.seed(1)
X <- matrix(rnorm(200*50), 200, 50)
w_true <- rep(0, 50); w_true[c(3,10,25)] <- c(0.2, 0.5, 0.3)
y <- X \%*\% w_true + rnorm(200, sd = 0.1)
w_hat <- fit_weights_fw(X, as.numeric(y), lambda = 1e-4)
sum(w_hat)  # should be ~1

}
